# SELECT I.ITEM_ID, I.ITEM_NAME, I.RARITY
# FROM ITEM_INFO  as I
# JOIN ITEM_TREE  as T
# on I.ITEM_ID = T.ITEM_ID
# WHERE T.PARENT_ITEM_ID 
# IN(
#     SELECT ITEM_ID
#     FROM ITEM_INFO 
#     WHERE RARITY = 'RARE'
# )
# ORDER BY I.ITEM_ID DESC

# SELECT b.ITEM_ID, b.ITEM_NAME, b.RARITY
# FROM ITEM_TREE as a
# JOIN ITEM_INFO as b on a.ITEM_ID = b.ITEM_ID
# JOIN ITEM_INFO as c on a.PARENT_ITEM_ID = c.ITEM_ID
# WHERE c.RARITY = 'RARE'
# ORDER BY a.ITEM_ID DESC

SELECT i.ITEM_ID, i.ITEM_NAME, i.RARITY
FROM ITEM_TREE as t
JOIN ITEM_INFO as i on t.ITEM_ID = i.ITEM_ID
JOIN ITEM_INFO as f on t.PARENT_ITEM_ID = f.ITEM_ID
WHERE f.RARITY = 'RARE'
ORDER BY i.ITEM_ID DESC
































